<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html>

<!--
  Licensed to the Apache Software Foundation (ASF) under one
  or more contributor license agreements.  See the NOTICE file
  distributed with this work for additional information
  regarding copyright ownership.  The ASF licenses this file
  to you under the Apache License, Version 2.0 (the
  "License"); you may not use this file except in compliance
  with the License.  You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing,
  software distributed under the License is distributed on an
  "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, either express or implied.  See the License for the
  specific language governing permissions and limitations
  under the License.
-->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="fr">
  <head>
    <title>Systèmes de références spatiales par coordonnées</title>
    <link rel="stylesheet" type="text/css" href="../book.css"/>
  </head>
  <body>
    <header>
      <h1 id="Referencing">Systèmes de références spatiales</h1>
    </header>
    <p>
      Pour donner une position sur la Terre on peut utiliser des noms tels que celui d’une ville ou une adresse postale
      — on parle alors de références spatiales par <cite>identifiants</cite> —
      ou on peut donner des valeurs numériques valides dans un système de coordonnées donné
      — on parle alors de références spatiales par <cite>coordonnées</cite>.
      Chaque système implique des approximations telles que:
    </p>
    <ul>
      <li>Le choix de la forme géométrique (géoïde, ellipsoïde, <i>etc.</i>) utilisée comme approximation de la forme de la Terre.</li>
      <li>Le choix des propriétés géométriques (angles, distances, <i>etc.</i>) à préserver lors de la représentation d’une carte sur une surface plane.</li>
      <li>Les pertes de précision lorsque l’on doit transformer des positions exprimées selon un système vers des positions exprimées selon un autre système.</li>
    </ul>
    <p>
      En l’absence d’indication contraire, la précision recherchée pour les coordonnées sur la Terre est de 1 centimètre.
      Mais la maîtrise de cette précision nécessite certaines conditions:
    </p>
    <ul>
      <li>Rester dans la zone de validité du système, telle que donnée par <code>ReferenceSystem.getDomainOfValidity()</code>.</li>
      <li>Savoir que les mesures de distances dans une projection cartographique donnée ne sont vraies qu’à certains endroits,
          appelés par exemple « parallèles standards ».</li>
      <li>Vérifier la précision des transformations de coordonnées, telle que donnée par
          <code>CoordinateOperation.getCoordinateOperationAccuracy()</code>.</li>
    </ul>
    <p>
      Le module <code>sis-referencing</code> de Apache <abbr>SIS</abbr> fournit une série de classes implémentant
      les différentes spécialisations de l’interface <code>ReferenceSystem</code> ainsi que leurs composantes.
      Ces implémentations permettent de stocker une description des systèmes de références spatiales
      ainsi que leurs méta-données telles que la zone de validité.
      Toutefois ces objets n’effectuent aucune opération sur les coordonnées.
      Ces opérations sont le travail d’une autre famille de classes, dont la racine est l’interface <code>CoordinateOperation</code>.
      Ces classes seront discutées dans <a href="#CoordinateOperation">une autre section</a>,
      mais nous citons ici deux spécialisations en rapport avec le sujet de la précision des coordonnées:
    </p>
    <ul>
      <li>
        <p>Les <strong>conversions</strong> de coordonnées sont entièrement définies par une formule mathématique.
        Les conversions s’effectueraient avec une précision infinie s’il n’y avait pas les inévitables
        erreurs d’arrondissements inhérents aux calculs sur des nombres réels.</p>
        <div class="example"><p><b>Exemple:</b> les projections cartographiques.</p></div>
      </li>
      <li><p>Les <strong>transformations</strong> de coordonnées sont définies de manière empirique.
        Elles ont souvent des erreurs de quelques mètres qui ne sont pas dues à des limites de la précision des ordinateurs.
        Ces erreurs découlent du fait que la transformation utilisée n’est qu’une approximation d’une réalité plus complexe.</p>
        <div class="example"><p><b>Exemple:</b> les changements de référentiels tel que le passage de la
        <cite>Nouvelle Triangulation Française</cite> (<abbr>NTF</abbr>) vers le
        <cite>Réseau Géodésique Français 1993</cite> (<abbr>RGF93</abbr>),
        même lorsque la méthode de projection cartographique (Lambert conique conforme) ne change pas.</p>
        </div>
      </li>
    </ul>



    <h2 id="CRS_Components">Composantes d’un système de références par coordonnées</h2>
    <p>
      Les systèmes de références spatiales par coordonnées fournissent les informations nécessaires pour faire
      correspondre des coordonnées numériques à des positions dans le monde réel. Dans Apache <abbr>SIS</abbr>,
      ils sont pratiquement tous représentés par des classes dont le nom se termine en <abbr>CRS</abbr>
      (l’abréviation de <i>Coordinate Reference System</i> en anglais). Ces objets contiennent:
    </p>
    <ul>
      <li>Un identifiant du référentiel (<i>datum</i> en anglais),
          qui indique entre autres quel ellipsoïde utiliser comme approximation de la forme de la terre.</li>
      <li>Une description de chaque axe (nom, direction, unité de mesure, limites).</li>
      <li>Parfois une liste de paramètres permettant de convertir les coordonnées d’un autre système.
          C’est le cas notamment des projections cartographiques.</li>
    </ul>
    <p>
      Ces systèmes sont décrits par la norme <abbr>ISO</abbr> 19111 (<i>Referencing by coordinates</i>),
      qui remplace en grande partie une norme plus ancienne mais encore utilisée pour certains aspects,
      <abbr>OGC 01-009</abbr> (<i>Coordinate Transformation Services</i>).
      Ces normes sont complétées par deux autres standards définissant des formats d’échanges:
      <abbr>ISO</abbr> 19136 et 19162 pour respectivement
      le <cite>Geographic Markup Language</cite> (<abbr>GML</abbr>) — un format <abbr>XML</abbr> précis mais verbeux —
      et le <cite>Well-Known Text</cite> (<abbr>WKT</abbr>) — un format texte plus facile à lire par les humains.
    </p>

    <h3 id="Ellipsoid">Géoïde et ellipsoïde</h3>
    <p>La surface topographique réelle étant difficile à représenter mathématiquement, elle n’est pas utilisée directement en cartographie.
       Une autre surface un peu plus facilement utilisable est le géoïde,
       une surface sur laquelle la force gravitationnelle a partout la même valeur (surface équipotentielle du champ de gravité terrestre).
       Cette surface est en tout point perpendiculaire à la direction indiquée par un fil à plomb (verticale du lieu).
       Le géoïde coïnciderait avec le niveau moyen des mers s’il n’y avait ni vent ni courants marins permanents comme le Gulf Stream.
    </p><p>
       Tout en étant nettement plus lisse que la surface topographique,
       le géoïde présente des creux et des bosses liés à l’inégale distribution des masses de la Terre.
       Pour une utilisation mathématiquement plus aisée, le géoïde est donc approximé par un ellipsoïde.
       Cette « figure de la Terre » est représentée dans GeoAPI par l’interface <code>Ellipsoid</code>,
       qui constitue un élément fondamental des systèmes de références de type <code>GeographicCRS</code> et <code>ProjectedCRS</code>.
       Plusieurs dizaines d’ellipsoïdes sont couramment employés, certains offrant une excellente approximation pour une région précise
       au détriment des régions pour lesquelles l’ellipsoïde n’a pas été conçu, et d’autres offrant un compromis pour l’ensemble de la planète.
    </p>
    <div class="example"><p><b>Exemple:</b>
      au début du XX<sup>e</sup> siècle aux États-Unis, l’état du Michigan utilisait pour ses cartes un ellipsoïde basé
      sur l’ellipsoïde « Clarke 1866 » mais auquel la longueur des axes a été allongée de 800 pieds.
      Cette modification visait à tenir compte du niveau moyen de l’état au dessus du niveau de la mer.</p>
    </div>

    <h3 id="GeodeticDatum">Référentiel géodésique</h3>
    <p>
      Pour définir un système géodésique dans un pays, l’état met en place un ellipsoïde de référence
      qui épouse au mieux sur l’ensemble du pays la forme locale du géoïde.
      L’écart entre cet ellipsoïde de référence et les creux et les bosses du géoïde reste généralement inférieur à 100 mètres.
      Les paramètres qui permettent de lier un <code>Ellipsoid</code> à la surface de la Terre (par exemple la position de son centre)
      sont encapsulés dans un objet de type <code>GeodeticDatum</code>, que l’on traduit en français par « référentiel géodésique ».
      Plusieurs <code>GeodeticDatum</code> peuvent utiliser le même <code>Ellipsoid</code>, mais centré ou orienté différemment.
    </p><p>
      Avant l’avènement des satellites, les mesures géodésiques se déroulaient exclusivement à la surface de la terre.
      En conséquence, deux îles ou continents qui ne sont pas à portée visuelle l’un de l’autre n’étaient pas rattachés géodésiquement entre eux.
      Ainsi les référentiels <cite>North American Datum 1983</cite> (<abbr>NAD83</abbr>) et <cite>European Datum 1950</cite> (<abbr>ED50</abbr>) sont indépendants l’un de l’autre:
      leurs ellipsoïdes de référence ont des centres distincts et des dimensions différentes.
      Une même coordonnée géographique correspondra à des positions différentes dans le monde réel
      selon que la coordonnée se réfère à l’un ou l’autre de ces référentiels.
    </p><p>
      L’invention du <abbr title="Global Positioning System">GPS</abbr> a précipité la création d’un système géodésique mondial,
      nommé <abbr title="World Geodetic System 1984">WGS84</abbr>.
      L’ellipsoïde de référence est alors unique et centré au centre de gravité de la terre.
      Les <abbr>GPS</abbr> donnent à tout moment la position absolue du récepteur rapportée à ce système géodésique.
      Mais <abbr>WGS84</abbr> étant un système mondial, il peut diverger significativement des systèmes locaux.
      Par exemple l’écart entre <abbr>WGS84</abbr> et le système européen <abbr>ED50</abbr> est de l’ordre de 150 mètres,
      et l’écart moyen par rapport au système de l’île de la Réunion 1947 est de 1,5 kilomètres.
      Il ne faut donc pas rapporter aveuglement des positions <abbr>GPS</abbr> sur une carte.
      Des correspondances avec les systèmes régionaux peuvent être nécessaires
      et sont représentées dans GeoAPI sous forme d’objets de type <code>Transformation</code>
      (une classe d’opérations mentionnée dans l’<a href="#Referencing">introduction de ce chapitre</a>).
    </p><p>
      Les généralisation de l’usage du système <abbr>WGS84</abbr> tend à réduire le besoin d’utiliser
      les objets <code>Transformation</code> pour les données récentes, mais ne l’élimine pas complètement.
      La Terre bouge sous l’effet de la tectonique des plaques et de nouveaux systèmes sont définis chaque année pour en tenir compte.
      Même le système <abbr>WGS84</abbr>, sensé correspondre à une définition à un instant donné,
      a subit des révisions dues notamment à l’amélioration de la précision des instruments.
      Ainsi il existe aujourd’hui au moins six versions de <abbr>WGS84</abbr>, avec des écarts entre elles allant jusqu’à 7 centimetres.
    </p>
    <article>
      <header>
        <h1>Bibliothèques de type « early binding » versus « late binding »</h1>
      </header>
      <p>
        Le caractère universel du système <abbr>WGS84</abbr> rend tentante l’idée de l’utiliser comme système pivot,
        afin de simplifier l’implémentation d’une bibliothèque de transformation de coordonnées.
        La transformation d’une coordonnées d’un référentiel <var>A</var> vers un référentiel <var>B</var>
        pourrait se faire en transformant d’abord de <var>A</var> vers <abbr>WGS84</abbr>, puis de <abbr>WGS84</abbr> vers <var>B</var>.
        Il suffirait ainsi de stocker dans chaque objet <code>GeodeticDatum</code> les informations nécessaires à la transformation vers <abbr>WGS84</abbr>.
        Cette approche était encouragée dans la version 1 du format <abbr>WKT</abbr>, qui définissait un élément <code>TOWGS84</code> remplissant ce rôle.
      </p><p>
        Cette approche est désignée par <abbr>EPSG</abbr> sous le nom de « early binding »,
        car elle associe des informations sur la transformations de coordonnées très tôt dans la définition des objets géodésiques.
        Bien que <abbr>EPSG</abbr> reconnaisse que cette approche soit couramment employée, elle n’est pas recommandée pour plusieurs raisons:
      </p>
      <ul>
        <li>Il existe parfois plusieurs transformations allant d’un référentiel <var>A</var> vers <abbr>WGS84</abbr>,
            chacune étant plus précise pour une région géographique donnée.
            Par exemple il existe une cinquantaine de transformations de <abbr>NAD27</abbr> vers <abbr>NAD83</abbr>.</li>
        <li>Certaines opérations sont conçues spécifiquement pour transformer de <var>A</var> vers <var>B</var>
            et n’ont pas la même précision qu’aurait une autre transformation faisant un détour par <abbr>WGS84</abbr>.</li>
        <li>Il existe d’autres systèmes globaux qui pourraient servir de pivot, par exemple le <cite>Galileo reference frame</cite> (<abbr>GTRF</abbr>)
            mis en place par le concurrent européen du <abbr>GPS</abbr>. Et <abbr>WGS84</abbr> lui-même subit parfois des révisions.</li>
      </ul>
      <p><abbr>EPSG</abbr> recommande plutôt d’utiliser une approche dite « late binding »,
        selon laquelle les paramètres nécessaires aux transformations de coordonnées sont définis pour des paires de
        référentiels « <var>A</var> vers <var>B</var> » plutôt qu’associés à des référentiels pris isolément.
        Apache <abbr>SIS</abbr> est une implémentation de type « late binding »,
        bien que quelques réminiscences de l’approche « early binding » existe toujours
        sous la forme de la propriété <code>DefaultGeodeticDatum.getBursaWolfParameters()</code>.</p>
    </article>

    <h3 id="CoordinateSystem">Systèmes de coordonnées</h3>
    <p>TODO</p>

    <h3 id="GeographicCRS">Systèmes géographiques</h3>
    <p>TODO</p>

    <h4 id="GeographicWKT">Format <i>Well-Known Text</i></h4>
    <p>TODO</p>

    <h3 id="ProjectedCRS">Projections cartographiques</h3>
    <p>TODO</p>

    <h4 id="ProjectedWKT">Format <i>Well-Known Text</i></h4>
    <p>TODO</p>

    <h3 id="CompoundCRS">Dimensions verticales et temporelles</h3>
    <p>TODO</p>

    <h4 id="CompoundWKT">Format <i>Well-Known Text</i></h4>
    <p>TODO</p>



    <h2 id="GetCRS">Obtention d’un système de référence spatial</h2>
    <p>TODO</p>

    <h3 id="CRSAuthorityFactory">Systèmes prédéfinis par des autorités</h3>
    <p>TODO</p>

    <h3 id="CRSParsing">Lecture d’une définition au format GML ou WKT</h3>
    <p>TODO</p>

    <h3 id="CRSFactory">Construction programmatique explicite</h3>
    <p>TODO</p>

    <h3 id="CRS_UserCode">Ajout de définitions</h3>
    <p>TODO</p>



    <h2 id="CoordinateOperation">Opérations sur les coordonnées</h2>
    <p>TODO</p>

    <h3 id="MathTransform">Exécution de opérations</h3>
    <p>TODO</p>
  </body>
</html>
