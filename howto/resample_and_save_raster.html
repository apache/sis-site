<!DOCTYPE html>
<html lang="en">
<head>


  <title>Apache SIS - Resample a raster and write to a file</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css"
        rel="stylesheet" integrity="sha384-F3w7mX95PdgyTmZZMECAngseQB83DfGTowi0iMjiWaeVhAn4FJkqJByhZMI3AhiU" crossorigin="anonymous">
  <link rel="stylesheet" type="text/css" media="screen" href="../syntax.css">
  <link rel="stylesheet" type="text/css" media="screen" href="../sis.css">
</head>

<body>

<nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
  <div class="container-fluid">
    <a class="navbar-brand" href="../index.html"> Apache SIS™</a>
    <ul class="navbar-nav me-auto mb-2 mb-md-0">
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" id="menuAbout" data-bs-toggle="dropdown" aria-expanded="false">About</a>
        <ul class="dropdown-menu" aria-labelledby="menuAbout">
          <li><a class="dropdown-item" href="http://www.apache.org/licenses/">License</a></li>
          <li><a class="dropdown-item" href="../mail-lists.html">Mailing Lists</a></li>
          <li><a class="dropdown-item" href="../team-list.html">Project Team</a></li>
        </ul>
      </li>
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" id="menuDownload" data-bs-toggle="dropdown" aria-expanded="false">Download</a>
        <ul class="dropdown-menu" aria-labelledby="menuDownload">
          <li><a class="dropdown-item" href="../downloads.html">Downloads</a></li>
          <li><a class="dropdown-item" href="../source.html">Checkout Sources</a></li>
          <li><a class="dropdown-item" href="../build.html">Build from Sources</a></li>
          <li><a class="dropdown-item" href="../epsg.html">EPSG Database</a></li>
        </ul>
      </li>
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" id="menuDocumentation" data-bs-toggle="dropdown" aria-expanded="false">Documentation</a>
        <ul class="dropdown-menu" aria-labelledby="menuDocumentation">
          <li><a class="dropdown-item" href="../apidocs/index.html">Online Javadoc</a></li>
          <li><a class="dropdown-item" href="../book/en/developer-guide.html">Developer Guide</a></li>
          <li><a class="dropdown-item" href="../howto.html">How to…</a></li>
          <li><a class="dropdown-item" href="../formats.html">Supported formats</a></li>
          <li><a class="dropdown-item" href="../tables/CoordinateReferenceSystems.html">Supported CRS</a></li>
          <li><a class="dropdown-item" href="../tables/CoordinateOperationMethods.html">Map Projections</a></li>
          <li><a class="dropdown-item" href="../code-patterns.html">Code Patterns</a></li>
          <li><a class="dropdown-item" href="../faq.html">FAQ</a></li>
        </ul>
      </li>
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" id="menuContribute" data-bs-toggle="dropdown" aria-expanded="false">Contribute</a>
        <ul class="dropdown-menu" aria-labelledby="menuContribute">
          <li><a class="dropdown-item" href="../contributor.html">New Contributor</a></li>
          <li><a class="dropdown-item" href="../coding-conventions.html">Coding Conventions</a></li>
          <li><a class="dropdown-item" href="../mail-lists.html">Mailing Lists</a></li>
          <li><a class="dropdown-item" href="https://issues.apache.org/jira/browse/SIS">Issue Tracker</a></li>
          <li><a class="dropdown-item" href="https://github.com/apache/sis">GitHub mirror</a></li>
          <li><a class="dropdown-item" href="https://cwiki.apache.org/confluence/display/SIS">Wiki</a></li>
          <li><hr class="dropdown-divider"></li>
          <li><a class="dropdown-item" href="../release-management.html">Release management</a></li>
        </ul>
      </li>
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" id="menuASF" data-bs-toggle="dropdown" aria-expanded="false">The Foundation</a>
        <ul class="dropdown-menu" aria-labelledby="menuASF">
          <li><a class="dropdown-item" href="http://www.apache.org">The Foundation</a></li>
          <li><a class="dropdown-item" href="http://www.apache.org/foundation/sponsorship.html">Donate</a></li>
          <li><a class="dropdown-item" href="http://www.apache.org/foundation/thanks.html">Thanks</a></li>
          <li><a class="dropdown-item" href="http://www.apache.org/security/">Security</a></li>
        </ul>
      </li>
    </ul>
    <ul class="navbar-nav ml-auto mb-2 mb-md-0">
      <li class="nav-item">
        <a href="https://www.apache.org/events/current-event.html">
           <img class="apache-con" src="https://www.apache.org/events/current-event-234x60.png" alt="ApacheCon"/>
        </a>
      </li>
    </ul>
  </div>
</nav>


<div class="row flex-nowrap">
  <div class="d-flex flex-column flex-shrink-0 p-3 text-white bg-dark" style="width:13rem; min-height:40rem">
    <ul class="nav nav-pills flex-column mb-auto position-fixed">
      <li><a class="nav-link  text-white " href="../index.html">Home</a></li>
      <li><a class="nav-link text-white" href="http://www.apache.org/licenses/">License</a></li>
      <li><a class="nav-link  text-white " href="../downloads.html">Downloads</a></li>
      <li><a class="nav-link  active " href="../howto.html">How to…</a></li>
      <li><a class="nav-link  text-white " href="../standards.html">Standards</a></li>
      <li><a class="nav-link  text-white " href="../formats.html">Data formats</a></li>
      <li><a class="nav-link  text-white " href="../epsg.html">EPSG Database</a></li>
      <li><a class="nav-link  text-white " href="../javafx.html">Application (demo)</a></li>
      <li><a class="nav-link text-white" href="../apidocs/index.html">Online Javadoc</a></li>
      <li><a class="nav-link text-white" href="../book/en/developer-guide.html">Developer Guide</a></li>
      <li><a class="nav-link  text-white " href="../code-patterns.html">Code patterns</a></li>
      <li><a class="nav-link  text-white " href="../faq.html">FAQ</a></li>
    </ul>
  </div>
  <div class="col">
    <main class="container">
      <article>
        <img src="../images/logo.png" class="sis-logo" align="left"/>
        <p class="page-title">Resample a raster and write to a file</p>

  <p>This example reads a raster in a GeoTIFF file
and reprojects it to a different Coordinate Reference System (CRS).
The result is saved as a World File in PNG format.</p>
<h1 id="direct-dependencies">Direct dependencies</h1>
<table>
<thead>
<tr>
<th>Maven coordinates</th>
<th>Module info</th>
<th>Remarks</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>org.apache.sis.storage:sis-geotiff</code></td>
<td><code>org.apache.sis.storage.geotiff</code></td>
<td></td>
</tr>
<tr>
<td><code>org.apache.sis.non-free:sis-embedded-data</code></td>
<td><code>org.apache.sis.referencing.database</code></td>
<td>Non-Apache license.</td>
</tr>
</tbody>
</table>
<p>The <a href="../epsg.html">EPSG dependency</a> is necessary for this example
because a Coordinate Reference System (CRS) is instantiated from its EPSG code.
But it would also be possible to specify a CRS without EPSG code,
for example using Well Known Text (WKT) format.</p>
<h1 id="code-snippet">Code snippet</h1>
<p>The file name in following snippet need to be updated for yours data.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">java.nio.file.Paths</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">java.util.Collection</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">java.awt.image.ImagingOpException</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.apache.sis.storage.Resource</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.apache.sis.storage.Aggregate</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.apache.sis.storage.DataStore</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.apache.sis.storage.DataStores</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.apache.sis.storage.DataStoreException</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.apache.sis.storage.GridCoverageResource</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.apache.sis.coverage.grid.GridCoverage</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.apache.sis.coverage.grid.GridCoverageProcessor</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.apache.sis.image.Interpolation</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.apache.sis.referencing.CRS</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.opengis.referencing.operation.TransformException</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.opengis.util.FactoryException</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ResampleAndSaveRaster</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * Demo entry point.
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param  args  ignored.
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @throws DataStoreException if an error occurred while reading the raster.
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @throws FactoryException   if an error occurred while creating the Coordinate Reference System (CRS).
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @throws TransformException if an error occurred while transforming coordinates to the target CRS.
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @throws ImagingOpException unchecked exception thrown if an error occurred while resampling a tile.
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">DataStoreException</span><span class="o">,</span> <span class="n">FactoryException</span><span class="o">,</span> <span class="n">TransformException</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span> <span class="o">(</span><span class="n">DataStore</span> <span class="n">store</span> <span class="o">=</span> <span class="n">DataStores</span><span class="o">.</span><span class="na">open</span><span class="o">(</span><span class="n">Paths</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;Airport.tiff&#34;</span><span class="o">)))</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="cm">/*
</span></span></span><span class="line"><span class="cl"><span class="cm">             * This data store is an aggregate because a GeoTIFF file may contain many images.
</span></span></span><span class="line"><span class="cl"><span class="cm">             * Not all data stores are aggregate, so the following casts do not apply to all.
</span></span></span><span class="line"><span class="cl"><span class="cm">             * For this example, we know that the file is GeoTIFF and we take the first image.
</span></span></span><span class="line"><span class="cl"><span class="cm">             */</span>
</span></span><span class="line"><span class="cl">            <span class="n">Collection</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">Resource</span><span class="o">&gt;</span> <span class="n">allImages</span> <span class="o">=</span> <span class="o">((</span><span class="n">Aggregate</span><span class="o">)</span> <span class="n">store</span><span class="o">).</span><span class="na">components</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="n">GridCoverageResource</span> <span class="n">firstImage</span> <span class="o">=</span> <span class="o">(</span><span class="n">GridCoverageResource</span><span class="o">)</span> <span class="n">allImages</span><span class="o">.</span><span class="na">iterator</span><span class="o">().</span><span class="na">next</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="cm">/*
</span></span></span><span class="line"><span class="cl"><span class="cm">             * The following code read fully the specified resource.
</span></span></span><span class="line"><span class="cl"><span class="cm">             * For reading only a subset, or for handling data bigger
</span></span></span><span class="line"><span class="cl"><span class="cm">             * than memory, see &#34;How to...&#34; in Apache SIS web site.
</span></span></span><span class="line"><span class="cl"><span class="cm">             */</span>
</span></span><span class="line"><span class="cl">            <span class="n">GridCoverage</span> <span class="n">data</span> <span class="o">=</span> <span class="n">firstImage</span><span class="o">.</span><span class="na">read</span><span class="o">(</span><span class="kc">null</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">&#34;Information about the selected image:%n%s%n&#34;</span><span class="o">,</span> <span class="n">data</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="cm">/*
</span></span></span><span class="line"><span class="cl"><span class="cm">             * Reproject to &#34;WGS 84 / World Mercator&#34; (EPSG::3395) using bilinear interpolation.
</span></span></span><span class="line"><span class="cl"><span class="cm">             * This example lets Apache SIS choose the output grid size and resolution.
</span></span></span><span class="line"><span class="cl"><span class="cm">             * But it is possible to specify those aspects if desired.
</span></span></span><span class="line"><span class="cl"><span class="cm">             */</span>
</span></span><span class="line"><span class="cl">            <span class="n">var</span> <span class="n">processor</span> <span class="o">=</span> <span class="k">new</span> <span class="n">GridCoverageProcessor</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="n">processor</span><span class="o">.</span><span class="na">setInterpolation</span><span class="o">(</span><span class="n">Interpolation</span><span class="o">.</span><span class="na">BILINEAR</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">data</span> <span class="o">=</span> <span class="n">processor</span><span class="o">.</span><span class="na">resample</span><span class="o">(</span><span class="n">data</span><span class="o">,</span> <span class="n">CRS</span><span class="o">.</span><span class="na">forCode</span><span class="o">(</span><span class="s">&#34;EPSG::3395&#34;</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">&#34;Information about the image after reprojection:%n%s%n&#34;</span><span class="o">,</span> <span class="n">data</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="cm">/*
</span></span></span><span class="line"><span class="cl"><span class="cm">             * TODO: Apache SIS is missing an `DataStores.write(…)` convenience method.
</span></span></span><span class="line"><span class="cl"><span class="cm">             * Writing a TIFF World File is possible but requires use of internal API.
</span></span></span><span class="line"><span class="cl"><span class="cm">             * A public convenience method will be added in next version.
</span></span></span><span class="line"><span class="cl"><span class="cm">             */</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span></span></span></code></pre></div>
<h1 id="output">Output</h1>
<p>The output depends on the raster data and the locale.
Below is an example:</p>
<pre tabindex="0"><code>Information about the image after reprojection:
GridCoverage2D
  ├─Coverage domain
  │   ├─Grid extent
  │   │   ├─Column: [0 … 8191] (8192 cells)
  │   │   └─Row:    [0 … 8191] (8192 cells)
  │   ├─Geographic extent
  │   │   ├─Lower bound:  48°59′20″N  02°31′33″E
  │   │   └─Upper bound:  49°01′08″N  02°34′16″E
  │   ├─Envelope
  │   │   ├─Easting:    465,341.6 … 468,618.39999999997  ∆E = 0.4 m
  │   │   └─Northing: 5,426,352.8 … 5,429,629.6          ∆N = 0.4 m
  │   ├─Coordinate reference system
  │   │   └─EPSG:32631 — WGS 84 / UTM zone 31N
  │   └─Conversion (origin in a cell center)
  │       └─┌                      ┐
  │         │ 0.4   0     465341.8 │
  │         │ 0    -0.4  5429629.4 │
  │         │ 0     0          1   │
  │         └                      ┘
  └─Image layout
      ├─Origin: 0, 0
      ├─Tile size: 8,192 × 128
      ├─Data type: byte
      └─Image is opaque.

Information about the image after reprojection:
GridCoverage2D
  ├─Coverage domain
  │   ├─Grid extent
  │   │   ├─Dimension 0: [0 … 8239] (8240 cells)
  │   │   └─Dimension 1: [0 … 8240] (8241 cells)
  │   ├─Geographic extent
  │   │   ├─Lower bound:  48°59′20″N  02°31′33″E
  │   │   └─Upper bound:  49°01′08″N  02°34′16″E
  │   ├─Envelope
  │   │   ├─Easting:   281,190.4273301751 … 286,207.11249780044  ∆E = 0.60882102 m
  │   │   └─Northing: 6,240,752.860382801 … 6,245,770.154371441  ∆N = 0.60882102 m
  │   ├─Coordinate reference system
  │   │   └─EPSG:3395 — WGS 84 / World Mercator
  │   └─Conversion (origin in a cell center)
  │       └─┌                                                            ┐
  │         │ 0.6088210154885099   0                  281190.73174068285 │
  │         │ 0                   -0.60882101548851  6245769.8499609330  │
  │         │ 0                    0                       1             │
  │         └                                                            ┘
  └─Image layout
      ├─Origin: 0, 0
      ├─Tile size: 1,648 × 201
      ├─Data type: byte
      └─Image is opaque.
</code></pre>

      </article>
    </main>
    <footer class="footer">
    <div class="container">
      <p>
        Copyright &copy; 2013-2023 The Apache Software Foundation, Licensed under the
        <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a>.<br/>
        Apache SIS, Apache, the Apache feather logo are trademarks of The Apache Software Foundation.
      </p>
    </div>
</footer>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-/bQdsTh/da6pkI1MST/rWKFNjaCP5gBSY4sEBT38Q/9RBh9AH40zEOg7Hlq2THRZ" crossorigin="anonymous"></script>

</body>
</html>
