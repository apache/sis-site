<!DOCTYPE html>
<html lang="en">

  <head>
    <title>Apache SIS - Get raster values at geographic coordinates</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" media="screen" href="../sis.css">
    <link rel="stylesheet" type="text/css" media="screen" href="../syntax.css">
  </head>
  <body>
    <div class="topbar">
      <a class="topbar-brand" href="../index.html">Apache SIS™</a>
      <ul class="topbar-items">
        <li>
          <a href="https://www.apache.org/events/current-event.html">
             <img class="apache-con" src="https://www.apache.org/events/current-event-234x60.png" alt="ApacheCon"/>
          </a>
        </li>
      </ul>
    </div>
    <div class="main-section">
      <nav class="left-bar">
        <ul class="nav-pills">
          <li><a class="nav-link  inactive " href="../index.html">Home</a></li>
          <li><a class="nav-link  inactive " href="../about.html">About</a></li>
          <li><a class="nav-link  inactive " href="../downloads.html">Downloads</a></li>
          <li><a class="nav-link  active " href="../howto.html">How to…</a></li>
          <li><a class="nav-link  inactive " href="../standards.html">Standards</a></li>
          <li><a class="nav-link  inactive " href="../formats.html">Data formats</a></li>
          <li><a class="nav-link  inactive " href="../epsg.html">EPSG Database</a></li>
          <li><a class="nav-link  inactive " href="../javafx.html">Application (demo)</a></li>
          <li><a class="nav-link  inactive " href="../documentation.html">Documentation</a></li>
        </ul>
      </nav>
      <div class="main-content">
        <main class="container">
          <article>
            <img src="../images/logo.png" class="sis-logo" align="left"/>
            <p class="page-title">Get raster values at geographic coordinates</p>

  <p>This example fetches values at given geospatial coordinates in a raster.
The coordinates can be expressed in different Coordinate Reference System (CRS).
Conversions from geographic or projected coordinates to pixel coordinates,
optionally followed by conversions from raster data to units of measurement,
are done automatically.
Raster data and spatiotemporal coordinates can have more than two dimensions.</p>
<p>This example assumes a preloaded three-dimensional raster.
For the loading part,
see <a href="../howto/read_netcdf.html">read from a netCDF file</a>
or <a href="../howto/read_geotiff.html">read from a GeoTIFF file</a>
code examples.</p>
<p>Some file formats store values as integers for compactness reasons,
but provide a <em>transfer function</em> for converting those integers to &ldquo;real world&rdquo; values.
Apache SIS can provide either the original integers or the converted values, at user&rsquo;s choice.
This choice is specified by the boolean argument in the <code>data.​forConvertedValues(…)</code> call.</p>
<h1 id="direct-dependencies">Direct dependencies</h1>
<table>
<thead>
<tr>
<th>Maven coordinates</th>
<th>Module info</th>
<th>Remarks</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>org.apache.sis.code:sis-feature</code></td>
<td><code>org.apache.sis.feature</code></td>
<td></td>
</tr>
</tbody>
</table>
<h1 id="code-example">Code example</h1>
<p>The geographic coordinates in following code need to be updated for yours data.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.Map</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">javax.measure.Unit</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.sis.coverage.grid.GridCoverage</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.sis.geometry.GeneralDirectPosition</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.sis.referencing.CommonCRS</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.sis.measure.Units</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">RasterValuesAtGeographicCoordinates</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * Demo entry point.
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param  args  ignored.
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">GridCoverage</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">...;</span><span class="w">      </span><span class="c1">// See &#34;Read netCDF&#34; or &#34;Read GeoTIFF&#34; code examples.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="cm">/*
</span></span></span><span class="line"><span class="cl"><span class="cm">         * Switch to a view of the data in the units of measurement.
</span></span></span><span class="line"><span class="cl"><span class="cm">         * Then get the unit of measurement of the first band (0).
</span></span></span><span class="line"><span class="cl"><span class="cm">         * If no unit is specified, fallback on dimensionless unit.
</span></span></span><span class="line"><span class="cl"><span class="cm">         */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="p">.</span><span class="na">forConvertedValues</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">band</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">0</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Unit</span><span class="o">&lt;?&gt;</span><span class="w"> </span><span class="n">unit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="p">.</span><span class="na">getSampleDimensions</span><span class="p">().</span><span class="na">get</span><span class="p">(</span><span class="n">band</span><span class="p">).</span><span class="na">getUnits</span><span class="p">().</span><span class="na">orElse</span><span class="p">(</span><span class="n">Units</span><span class="p">.</span><span class="na">UNITY</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="cm">/*
</span></span></span><span class="line"><span class="cl"><span class="cm">         * Get raster values at geographic coordinates expressed in WGS84.
</span></span></span><span class="line"><span class="cl"><span class="cm">         * Coordinate values in this example are in (latitude, longitude) order.
</span></span></span><span class="line"><span class="cl"><span class="cm">         * Any compatible coordinate reference system (CRS) can be used below,
</span></span></span><span class="line"><span class="cl"><span class="cm">         * Apache SIS will automatically transform to the CRS used by the raster.
</span></span></span><span class="line"><span class="cl"><span class="cm">         * If the raster data are three-dimensional, a 3D CRS should be specified.
</span></span></span><span class="line"><span class="cl"><span class="cm">         */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;Evaluation at some (latitude, longitude) coordinates:&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="n">point</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">GeneralDirectPosition</span><span class="p">(</span><span class="n">CommonCRS</span><span class="p">.</span><span class="na">WGS84</span><span class="p">.</span><span class="na">geographic</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">GridCoverage</span><span class="p">.</span><span class="na">Evaluator</span><span class="w"> </span><span class="n">eval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="p">.</span><span class="na">evaluator</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="cm">/*
</span></span></span><span class="line"><span class="cl"><span class="cm">         * If the data are three-dimensional but we still want to use two-dimensional
</span></span></span><span class="line"><span class="cl"><span class="cm">         * coordinates, we need to specify a default value for the temporal dimension.
</span></span></span><span class="line"><span class="cl"><span class="cm">         * This code set the default to slice 0 (the first slice) in dimension 2.
</span></span></span><span class="line"><span class="cl"><span class="cm">         * Omit this line if the data are two-dimensional or if `point` has a 3D CRS.
</span></span></span><span class="line"><span class="cl"><span class="cm">         */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">eval</span><span class="p">.</span><span class="na">setDefaultSlice</span><span class="p">(</span><span class="n">Map</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="n">2</span><span class="p">,</span><span class="w"> </span><span class="n">0L</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="cm">/*
</span></span></span><span class="line"><span class="cl"><span class="cm">         * The same `Evaluator` can be reused as often as needed for evaluating
</span></span></span><span class="line"><span class="cl"><span class="cm">         * at many points.
</span></span></span><span class="line"><span class="cl"><span class="cm">         */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">point</span><span class="p">.</span><span class="na">setCoordinate</span><span class="p">(</span><span class="n">40</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">10</span><span class="p">);</span><span class="w">           </span><span class="c1">// 40°N 10°W</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kt">double</span><span class="o">[]</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">eval</span><span class="p">.</span><span class="na">apply</span><span class="p">(</span><span class="n">point</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">printf</span><span class="p">(</span><span class="s">&#34;- Value at %s is %g %s.%n&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">point</span><span class="p">,</span><span class="w"> </span><span class="n">values</span><span class="o">[</span><span class="n">band</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">unit</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">point</span><span class="p">.</span><span class="na">setCoordinate</span><span class="p">(</span><span class="n">30</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">15</span><span class="p">);</span><span class="w">           </span><span class="c1">// 30°N 15°W</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">eval</span><span class="p">.</span><span class="na">apply</span><span class="p">(</span><span class="n">point</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">printf</span><span class="p">(</span><span class="s">&#34;- Value at %s is %g %s.%n&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">point</span><span class="p">,</span><span class="w"> </span><span class="n">values</span><span class="o">[</span><span class="n">band</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">unit</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h1 id="output">Output</h1>
<p>The output depends on the raster data and the locale.
Below is an example:</p>
<pre tabindex="0"><code>Evaluation at some (latitude, longitude) coordinates:
- Value at POINT(40 -10) is 0.188000 m.
- Value at POINT(30 -15) is 0.619000 m.
</code></pre>

          </article>
        </main>
        <footer>
          <div class="container">
            <p>Copyright &copy; 2013-2025 The Apache Software Foundation, Licensed under the
            <a href="https://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a>.<br/>
            Apache SIS, Apache, the Apache feather logo are trademarks of The Apache Software Foundation.</p>
          </div>
        </footer>
      </div>
    </div>
  </body>
</html>
