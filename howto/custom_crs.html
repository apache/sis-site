<!DOCTYPE html>
<html lang="en">

  <head>
    <title>Apache SIS - Extend with custom Coordinate Reference Systems</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" media="screen" href="../sis.css">
    <link rel="stylesheet" type="text/css" media="screen" href="../syntax.css">
  </head>
  <body>
    <div class="topbar">
      <a class="topbar-brand" href="../index.html">Apache SIS™</a>
      <ul class="topbar-items">
        <li>
          <a href="https://www.apache.org/events/current-event.html">
             <img class="apache-con" src="https://www.apache.org/events/current-event-234x60.png" alt="ApacheCon"/>
          </a>
        </li>
      </ul>
    </div>
    <div class="main-section">
      <nav class="left-bar">
        <ul class="nav-pills">
          <li><a class="nav-link  inactive " href="../index.html">Home</a></li>
          <li><a class="nav-link  inactive " href="../about.html">About</a></li>
          <li><a class="nav-link  inactive " href="../downloads.html">Downloads</a></li>
          <li><a class="nav-link  active " href="../howto.html">How to…</a></li>
          <li><a class="nav-link  inactive " href="../standards.html">Standards</a></li>
          <li><a class="nav-link  inactive " href="../formats.html">Data formats</a></li>
          <li><a class="nav-link  inactive " href="../epsg.html">EPSG Database</a></li>
          <li><a class="nav-link  inactive " href="../javafx.html">Application (demo)</a></li>
          <li><a class="nav-link  inactive " href="../documentation.html">Documentation</a></li>
        </ul>
      </nav>
      <div class="main-content">
        <main class="container">
          <article>
            <img src="../images/logo.png" class="sis-logo" align="left"/>
            <p class="page-title">Extend with custom Coordinate Reference Systems</p>

  <p>An application can associate its own authority codes to custom Coordinate Reference System (CRS) definitions.
Such custom CRS definitions can be written in Well-Known Text (WKT) format in any text file,
and declared to Apache SIS using the service provider mechanism.
After those steps, custom Coordinate Reference Systems can be created
in the same way as for EPSG definitions, with calls to <code>CRS.forCode(String)</code>.</p>
<h1 id="direct-dependencies">Direct dependencies</h1>
<table>
  <thead>
      <tr>
          <th>Maven coordinates</th>
          <th>Module info</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>org.apache.sis.core:sis-metadata</code></td>
          <td><code>org.apache.sis.metadata</code></td>
      </tr>
      <tr>
          <td><code>org.apache.sis.core:sis-referencing</code></td>
          <td><code>org.apache.sis.referencing</code></td>
      </tr>
  </tbody>
</table>
<h1 id="example-of-crs-definitions">Example of CRS definitions</h1>
<p>The first step is to choose an authority name.
This page uses &ldquo;MyOrg&rdquo;, but applications should replace by their own names.
Then, the additional CRS definitions can be written in WKT format in a text file.
The file can contain as many definitions as desired.
Each CRS definition must end with an <code>ID[authority, code]</code> element where <em>authority</em>
is the chosen authority name, and <em>code</em> is an arbitrary code managed by that authority.
The codes are often numerical, but not necessarily:
alphanumeric codes between quotes are also accepted.
Example:</p>
<pre tabindex="0"><code class="language-wkt" data-lang="wkt">ProjectedCRS[&#34;North Pole Azimuthal Equidistant&#34;,
 BaseGeodCRS[&#34;WGS 1984&#34;,
  Datum[&#34;World Geodetic System 1984&#34;,
   Ellipsoid[&#34;WGS 1984&#34;, 6378137, 298.257223563]],
  AngleUnit[&#34;Degree&#34;, 0.0174532925199433]],
 Conversion[&#34;North Pole Azimuthal Equidistant&#34;,
  Method[&#34;Azimuthal Equidistant (Spherical)&#34;],
  Parameter[&#34;Latitude of natural origin&#34;, 90]],
 CS[Cartesian, 2],
  Axis[&#34;Easting (E)&#34;, east],
  Axis[&#34;Northing (N)&#34;, north],
  Unit[&#34;metre&#34;, 1],
 Id[&#34;MyOrg&#34;, 102016]]

ProjectedCRS[&#34;North Pole Stereographic&#34;,
  ...
  Id[&#34;MyOrg&#34;, 102018]]
</code></pre><h2 id="more-compact-definitions-non-standard">More compact definitions (non-standard)</h2>
<p>A file with many CRS definitions may contain a lot of redundancy.
For example, the <code>BaseGeodCRS</code> and <code>CS</code> elements are often repeated verbatim in many <code>ProjectedCRS</code> definitions.
Apache SIS has a non-standard mechanism for declaring WKT fragments and reusing them in many CRS definitions.
The fragments can be declared with a <code>SET</code> directive, and reused by prefixing a fragment name with <code>$</code>.
Example for the same CRS than above:</p>
<pre tabindex="0"><code class="language-wkt" data-lang="wkt">SET WGS84_BASE =
 BaseGeodCRS[&#34;WGS 1984&#34;,
  Datum[&#34;World Geodetic System 1984&#34;,
   Ellipsoid[&#34;WGS 1984&#34;, 6378137, 298.257223563]],
  AngleUnit[&#34;Degree&#34;, 0.0174532925199433]]

SET CARTESIAN_CS =
 CS[Cartesian, 2],
  Axis[&#34;Easting (E)&#34;, east],
  Axis[&#34;Northing (N)&#34;, north],
  Unit[&#34;metre&#34;, 1]

ProjectedCRS[&#34;North Pole Azimuthal Equidistant&#34;,
 $WGS84_BASE,
 Conversion[&#34;North Pole Azimuthal Equidistant&#34;,
  Method[&#34;Azimuthal Equidistant (Spherical)&#34;],
  Parameter[&#34;Latitude of natural origin&#34;, 90]],
 $CARTESIAN_CS,
 Id[&#34;MyOrg&#34;, 102016]]
</code></pre><p>The above examples are available with more explanations in a <a href="https://sis.apache.org/apidocs/org.apache.sis.referencing/org/apache/sis/io/wkt/doc-files/ESRI.txt">text file</a>.</p>
<h1 id="java-code">Java code</h1>
<p>A Java application can load CRS definitions from above file like below
(see the <a href="https://sis.apache.org/apidocs/org.apache.sis.referencing/org/apache/sis/io/wkt/WKTDictionary.html">Javadoc</a> for more information).
Replace <code>&quot;MyOrg&quot;</code> by the chosen authority name and <code>&quot;MyRegistry.txt&quot;</code> by the
filename of the text file containing CRS definitions in WKT format:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span><span class="w"> </span><span class="nn">org.myorg</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.io.BufferedReader</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.io.IOException</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.nio.file.Files</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.nio.file.Path</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.sis.io.wkt.WKTDictionary</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.sis.metadata.iso.citation.DefaultCitation</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">org.opengis.referencing.crs.CRSAuthorityFactory</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">org.opengis.util.FactoryException</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">MyRegistry</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">WKTDictionary</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">CRSAuthorityFactory</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">MyRegistry</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">IOException</span><span class="p">,</span><span class="w"> </span><span class="n">FactoryException</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">super</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">DefaultCitation</span><span class="p">(</span><span class="s">&#34;MyOrg&#34;</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">(</span><span class="n">BufferedReader</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Files</span><span class="p">.</span><span class="na">newBufferedReader</span><span class="p">(</span><span class="n">Path</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="s">&#34;MyRegistry.txt&#34;</span><span class="p">)))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">load</span><span class="p">(</span><span class="n">source</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>Finally, the application needs to declare the above class as a service in its <code>module-info.java</code> file:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">module</span><span class="w"> </span><span class="n">org</span><span class="p">.</span><span class="na">myorg</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">requires</span><span class="w"> </span><span class="n">org</span><span class="p">.</span><span class="na">apache</span><span class="p">.</span><span class="na">sis</span><span class="p">.</span><span class="na">referencing</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">provides</span><span class="w"> </span><span class="n">org</span><span class="p">.</span><span class="na">opengis</span><span class="p">.</span><span class="na">referencing</span><span class="p">.</span><span class="na">crs</span><span class="p">.</span><span class="na">CRSAuthorityFactory</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">org</span><span class="p">.</span><span class="na">myorg</span><span class="p">.</span><span class="na">MyRegistry</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>Alternatively, non-modular applications can register in <code>META-INF/services/</code> instead.</p>
<h1 id="usage">Usage</h1>
<p>After all above steps have been completed, the <code>org.apache.sis.referencing.CRS</code> class should recognize the custom authority codes.
For example, a call to <code>CRS.forCode(&quot;MyOrg:102016&quot;)</code> should return the <code>ProjectedCRS</code> defined in above example.</p>


          </article>
        </main>
        <footer>
          <div class="container">
            <p>Copyright &copy; 2013-2025 The Apache Software Foundation, Licensed under the
            <a href="https://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a>.<br/>
            Apache SIS, Apache, the Apache feather logo are trademarks of The Apache Software Foundation.</p>
          </div>
        </footer>
      </div>
    </div>
  </body>
</html>
